<div class="dashboard-container">
  <h1>Ordenes</h1>

  <ng-container *ngIf="orders.length > 0" class="card flex flex-row gap-4">
    <form [formGroup]="formGroup!">
      <div class="card flex flex-row gap-4 align-items-end" >

        <div class="flex flex-column" >

        <label for="username">Periodo de tiempo</label>
        <p-calendar
          [(ngModel)]="rangeDates"
          formControlName="date"
          selectionMode="range"
          [iconDisplay]="'input'"
          [showIcon]="true"
          dateFormat="dd/mm/yy"
        />
      </div>
      <div class="flex flex-column" >
        <label for="username">Estado</label>
        <p-dropdown
          [options]="states"
          formControlName="selectedState"
          placeholder="Elije el estado"
          [attr.enjisst]="'cart__payment__value'"
        >
          <ng-template
            let-state
            pTemplate="item"
            [attr.enjisst]="'cart__payment__opt' + index"
          >
            <div class="flex align-items-center gap-2 w-100">
              <div>{{ state }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
      <div class="flex flex-column"  >
        <p-button
          label="Limpiar"
          (onClick)="clearFilters()"
          [attr.enjisst]="'cart'"
          />
      </div>
      </div>
      </form>

  </ng-container>

  <div class="card">
    <p-dataView #dv [value]="orders">
      <ng-template pTemplate="list" let-products>
        <div class="grid grid-nogutter">
          <div
            class="col-12"
            *ngFor="let item of filteredOrders; let first = first; let i = index"
            class="col-12"
          >
            <div
              class="flex flex-column sm:flex-row sm:align-items-center p-4 gap-3"
              [ngClass]="{ 'border-top-1 surface-border': !first }"
            >
              <!-- <div class="md:w-10rem relative">
                            <img class="block xl:block mx-auto border-round w-full" [src]="'https://primefaces.org/cdn/primeng/images/demo/product/' + item.image" [alt]="item.name" />
                            <p-tag [value]="item.inventoryStatus" [severity]="getSeverity(item)" class="absolute" [style.left.px]="4" [style.top.px]="4" />
                        </div> -->
              <div
                class="flex flex-column md:flex-row justify-content-between md:align-items-center flex-1 gap-4"
              >
                <div
                  class="flex flex-row md:flex-column justify-content-between align-items-start gap-2"
                >
                  <div>
                    <span class="font-medium">Orden {{ item.id }}</span>
                    <div
                      class="text-lg font-medium text-secondary text-900 mt-2 text-sm"
                    >
                      {{ item.fecha_pedido | date : "dd/MM/yyyy" }}
                    </div>
                  </div>
                  <!-- <div class="surface-100 p-1" style="border-radius: 30px">
                                    <div class="surface-0 flex align-items-center gap-2 justify-content-center py-1 px-2" style="border-radius: 30px; box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, 0.04), 0px 1px 2px 0px rgba(0, 0, 0, 0.06)">
                                        <span class="text-900 font-medium text-sm">{{ item.rating }}</span>
                                        <i class="pi pi-star-fill text-yellow-500"></i>
                                    </div>
                                </div> -->
                </div>
                <div class="flex flex-column md:align-items-end gap-5">
                  <p-tag
                    *ngIf="item.estado === 'entregado'"
                    severity="success"
                    [value]="item.estado"
                  />
                  <p-tag
                    *ngIf="item.estado === 'en preparación'"
                    severity="warning"
                    [value]="item.estado"
                  />
                  <p-tag
                    *ngIf="item.estado === 'cancelado'"
                    severity="secondary"
                    [value]="item.estado"
                  />
                  <!-- <span class="text-xl font-semibold text-900">{{item.estado }}</span> -->
                  <div
                    *ngIf="item.estado === 'en preparación'"
                    class="flex flex-row-reverse md:flex-row gap-2"
                  >
                    <p-button
                      class="flex-auto md:flex-initial white-space-nowrap"
                      label="Cancelar"
                      severity="warning"
                      [disabled]="item.estado === 'entregado'"
                      [attr.enjisst]="'order' + i"
                      (onClick)="cancelOrder(item, i)"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </p-dataView>
  </div>
</div>
